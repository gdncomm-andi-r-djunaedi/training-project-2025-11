info.app.version=@project.version@
spring.application.name=@project.artifactId@
server.port=${HTTP_REST_PORT:8083}

# gRPC Configuration
grpc.server.port=${GRPC_SERVER_PORT:9092}
grpc.server.address=0.0.0.0
grpc.transcoding.enabled=true
# Enable gRPC Server Reflection (required for dynamic gateway routing)
grpc.server.reflection-service-enabled=true

# ===========================================
# Embedded gRPC UI (Local Development)
# ===========================================
# Access at: http://localhost:{port}/grpc-ui
# No external tools required!
grpc.ui.enabled=${GRPC_UI_ENABLED:true}
# Allow clients to send keepalive pings more frequently (default is 5 min)
grpc.server.permit-keep-alive-time=30s
grpc.server.permit-keep-alive-without-calls=true
grpc.server.keep-alive-time=60s
grpc.server.keep-alive-timeout=20s
grpc.client.cart-service.address=${GRPC_CART_ADDRESS:static://localhost:9092}
grpc.client.cart-service.negotiation-type=plaintext
grpc.client.catalog-service.address=${GRPC_CATALOG_ADDRESS:static://localhost:9091}
grpc.client.catalog-service.negotiation-type=plaintext
grpc.client.member-service.address=${GRPC_MEMBER_ADDRESS:static://localhost:9090}
grpc.client.member-service.negotiation-type=plaintext

# MongoDB Configuration
# For local dev without auth: mongodb://localhost:27017/cart
# For Docker with auth: mongodb://admin:admin@mongodb:27017/cart?authSource=admin
spring.data.mongodb.uri=${MONGODB_URI:mongodb://admin:admin@localhost:27017/cart?authSource=admin}
spring.data.mongodb.auto-index-creation=true

# ===========================================
# Redis Configuration (Standalone or Sentinel)
# ===========================================
# Default: Standalone mode (for local development)
# To enable Sentinel: set REDIS_SENTINEL_MASTER and REDIS_SENTINEL_NODES env vars

# Standalone Redis config (used when Sentinel is not configured)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.database=${REDIS_DATABASE:0}
spring.data.redis.password=${REDIS_PASSWORD:}

# Lettuce client pool config
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=0
spring.data.redis.timeout=2000ms

# Default pagination
default.item-per-page=10

# Cart/Checkout Configuration
cart.checkout.ttl-seconds=${CHECKOUT_TTL_SECONDS:900}
cart.checkout.use-redis=${CHECKOUT_USE_REDIS:true}

# Checkout Expiry Scheduler
# Enabled by default - set to false to disable automatic expiry processing
cart.checkout.expiry-scheduler.enabled=${CHECKOUT_EXPIRY_SCHEDULER_ENABLED:true}
# Cron expression: default runs every minute
cart.checkout.expiry-scheduler.cron=${CHECKOUT_EXPIRY_SCHEDULER_CRON:0 * * * * *}

# Mongock Migration
mongock.enabled=true
mongock.change-logs-scan-package=com.gdn.project.waroenk.cart.migration

# ===========================================
# Actuator Configuration (for monitoring dashboard)
# ===========================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.info.java.enabled=true
management.info.os.enabled=true
