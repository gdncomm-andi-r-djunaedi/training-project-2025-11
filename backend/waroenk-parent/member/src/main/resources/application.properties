info.app.version=@project.version@
spring.application.name=@project.artifactId@
server.port=${HTTP_REST_PORT:8080}
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true
grpc.server.port=${GRPC_SERVER_PORT:9090}
grpc.server.address=0.0.0.0
grpc.transcoding.enabled=true
# Allow clients to send keepalive pings more frequently (default is 5 min)
grpc.server.permit-keep-alive-time=30s
grpc.server.permit-keep-alive-without-calls=true
grpc.server.keep-alive-time=60s
grpc.server.keep-alive-timeout=20s
grpc.client.member-service.address=static://localhost:9090
grpc.client.member-service.negotiation-type=plaintext

# Use 'none' with Flyway - let Flyway manage schema completely
spring.jpa.hibernate.ddl-auto=none
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.url=jdbc:postgresql://${DB_HOSTS:localhost:5432}/${DB_NAME:userdb}?currentSchema=${DB_SCHEMA:public}
spring.datasource.username=${DB_USERNAME:admin}
spring.datasource.password=${DB_PASSWORD:admin}

# ===========================================
# Redis Configuration (Standalone or Sentinel)
# ===========================================
# Default: Standalone mode (for local development)
# To enable Sentinel: set REDIS_SENTINEL_MASTER and REDIS_SENTINEL_NODES env vars

# Standalone Redis config (used when Sentinel is not configured)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.database=${REDIS_DATABASE:0}
spring.data.redis.password=${REDIS_PASSWORD:}

# Lettuce client pool config
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=0
spring.data.redis.timeout=2000ms
# Spring Session Redis config
spring.session.store-type=redis
spring.session.redis.namespace=spring:session

# Data migration config
spring.flyway.lock-retry-count=10
spring.flyway.enabled=${MIGRATE_DATABASE:true}
# Repair mode: set to true once to fix checksum mismatch, then set back to false
spring.flyway.repair-on-migrate=${FLYWAY_REPAIR:false}

# Pagination setting
default.item-per-page=10

# JWT Configuration
jwt.secret=${JWT_SECRET:c2VjdXJlLXNlY3JldC1rZXktZm9yLWp3dC10b2tlbi1nZW5lcmF0aW9uLW1pbmltdW0tMjU2LWJpdHM=}

# ===========================================
# API Gateway Registration (CI/CD Friendly)
# ===========================================
# Registration is ENABLED by default (uses upsert - safe to always run)
# Set to 'false' to disable registration (e.g., for isolated local testing)
gateway.registration.enabled=${GATEWAY_REGISTRATION_ENABLED:true}
# API Gateway host (use service name in Docker, hostname locally)
gateway.host=${GATEWAY_HOST:api-gateway}
# API Gateway gRPC port for registration
gateway.grpc.port=${GATEWAY_GRPC_PORT:6565}