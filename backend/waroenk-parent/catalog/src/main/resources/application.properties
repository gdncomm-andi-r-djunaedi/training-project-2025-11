info.app.version=@project.version@
spring.application.name=@project.artifactId@
server.port=${HTTP_REST_PORT:8082}

# gRPC Configuration
grpc.server.port=${GRPC_SERVER_PORT:9091}
grpc.server.address=0.0.0.0
grpc.transcoding.enabled=true
# Enable gRPC Server Reflection (required for dynamic gateway routing)
grpc.server.reflection-service-enabled=true

# ===========================================
# Embedded gRPC UI (Local Development)
# ===========================================
# Access at: http://localhost:{port}/grpc-ui
# No external tools required!
grpc.ui.enabled=${GRPC_UI_ENABLED:true}
# Allow clients to send keepalive pings more frequently (default is 5 min)
grpc.server.permit-keep-alive-time=30s
grpc.server.permit-keep-alive-without-calls=true
grpc.server.keep-alive-time=60s
grpc.server.keep-alive-timeout=20s
grpc.client.catalog-service.address=static://localhost:9091
grpc.client.catalog-service.negotiation-type=plaintext
grpc.client.member-service.address=static://localhost:9090
grpc.client.member-service.negotiation-type=plaintext


# MongoDB Configuration
# For local dev without auth: mongodb://localhost:27017/catalog
# For Docker with auth: mongodb://admin:admin@mongodb:27017/catalog?authSource=admin
spring.data.mongodb.uri=${MONGODB_URI:mongodb://admin:admin@localhost:27017/catalog?authSource=admin}
spring.data.mongodb.auto-index-creation=true

# ===========================================
# Redis Configuration (Standalone or Sentinel)
# ===========================================
# Default: Standalone mode (for local development)
# To enable Sentinel: set REDIS_SENTINEL_MASTER and REDIS_SENTINEL_NODES env vars

# Standalone Redis config (used when Sentinel is not configured)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.database=${REDIS_DATABASE:0}
spring.data.redis.password=${REDIS_PASSWORD:}

# Lettuce client pool config
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=0
spring.data.redis.timeout=2000ms

# Typesense Configuration (Search Engine)
typesense.configuration.client.initialize-schema=true
typesense.configuration.client.collection-name=vector_store
typesense.configuration.client.embedding-dimension=1536
typesense.configuration.client.protocol=${TYPESENSE_PROTOCOL:http}
typesense.configuration.client.host=${TYPESENSE_HOST:localhost}
typesense.configuration.client.port=${TYPESENSE_PORT:8108}
typesense.configuration.client.api-key=${TYPESENSE_API_KEY:3W0P3tJOWFxsH9NI7VViW4ve1XNde0Om}
typesense.configuration.client.timeout=5
typesense.configuration.client.connection-retries=10
typesense.configuration.client.retry-interval-in-seconds=5

# Default pagination
default.item-per-page=10

# Mongock Migration
mongock.enabled=true
mongock.change-logs-scan-package=com.gdn.project.waroenk.catalog.migration

# ===========================================
# API Gateway Registration (CI/CD Friendly)
# ===========================================
# Registration is ENABLED by default (uses upsert - safe to always run)
# Set to 'false' to disable registration (e.g., for isolated local testing)
gateway.registration.enabled=${GATEWAY_REGISTRATION_ENABLED:true}
# API Gateway host (use service name in Docker, hostname locally)
gateway.host=${GATEWAY_HOST:api-gateway}
# API Gateway gRPC port for registration
gateway.grpc.port=${GATEWAY_GRPC_PORT:6565}

# ===========================================
# Actuator Configuration (for monitoring dashboard)
# ===========================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.info.java.enabled=true
management.info.os.enabled=true
