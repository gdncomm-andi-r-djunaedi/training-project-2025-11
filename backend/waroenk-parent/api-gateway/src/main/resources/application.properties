# ===========================================
# Application Info
# ===========================================
info.app.version=@project.version@
spring.application.name=@project.artifactId@

# ===========================================
# Server Configuration
# ===========================================
server.port=${HTTP_REST_PORT:8080}
# Tomcat thread pool (tune for your workload)
server.tomcat.threads.max=100
server.tomcat.threads.min-spare=10
server.tomcat.accept-count=100
server.tomcat.connection-timeout=10000

# ===========================================
# Logging (reduce verbosity for stability)
# ===========================================
logging.level.root=WARN
logging.level.com.gdn.project.waroenk.gateway=INFO
logging.level.io.grpc=WARN
logging.level.io.netty=WARN
logging.level.org.springframework=WARN
logging.level.org.springframework.web=INFO

# ===========================================
# Swagger/OpenAPI Configuration
# ===========================================
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true

# ===========================================
# Actuator Configuration
# ===========================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.info.java.enabled=true
management.info.os.enabled=true

# ===========================================
# JWT Configuration
# ===========================================
gateway.jwt.secret=${JWT_SECRET:c2VjdXJlLXNlY3JldC1rZXktZm9yLWp3dC10b2tlbi1nZW5lcmF0aW9uLW1pbmltdW0tMjU2LWJpdHM=}
gateway.jwt.access-token-expiration=3600
gateway.jwt.refresh-token-expiration=604800

# ===========================================
# gRPC Service Endpoints (Static Configuration)
# All routes are loaded from this file at startup.
# No database or Redis required.
# ===========================================
gateway.services.member.host=${MEMBER_GRPC_HOST:localhost}
gateway.services.member.port=${MEMBER_GRPC_PORT:9090}
gateway.services.member.http-port=${MEMBER_HTTP_PORT:8081}
gateway.services.member.use-tls=false

gateway.services.catalog.host=${CATALOG_GRPC_HOST:localhost}
gateway.services.catalog.port=${CATALOG_GRPC_PORT:9091}
gateway.services.catalog.http-port=${CATALOG_HTTP_PORT:8082}
gateway.services.catalog.use-tls=false

gateway.services.cart.host=${CART_GRPC_HOST:localhost}
gateway.services.cart.port=${CART_GRPC_PORT:9092}
gateway.services.cart.http-port=${CART_HTTP_PORT:8083}
gateway.services.cart.use-tls=false

# ===========================================
# Public Paths (No authentication required)
# ===========================================
gateway.public-paths[0]=/health
gateway.public-paths[1]=/info
gateway.public-paths[2]=/routes
gateway.public-paths[3]=/services
gateway.public-paths[4]=/actuator/**
gateway.public-paths[5]=/swagger-ui.html
gateway.public-paths[6]=/swagger-ui/**
gateway.public-paths[7]=/api-docs
gateway.public-paths[8]=/api-docs/**
gateway.public-paths[9]=/v3/api-docs
gateway.public-paths[10]=/v3/api-docs/**
gateway.public-paths[11]=/dashboard
gateway.public-paths[12]=/dashboard/**
gateway.public-paths[13]=/monitoring/**

# ===========================================
# Static Route Configuration
# All HTTP to gRPC routing is defined here.
# Uses gRPC Server Reflection for dynamic type discovery.
# ===========================================

# =====================================================
# MEMBER SERVICE ROUTES
# =====================================================

# User Routes (Member Service)
gateway.routes[0].path=/api/user/**
gateway.routes[0].service=member
gateway.routes[0].grpc-service=member.user.UserService
gateway.routes[0].public-route=false

gateway.routes[0].methods[0].http-method=POST
gateway.routes[0].methods[0].http-path=/api/user/register
gateway.routes[0].methods[0].grpc-method=Register
gateway.routes[0].methods[0].public-endpoint=true

gateway.routes[0].methods[1].http-method=POST
gateway.routes[0].methods[1].http-path=/api/user/login
gateway.routes[0].methods[1].grpc-method=Authenticate
gateway.routes[0].methods[1].public-endpoint=true

gateway.routes[0].methods[2].http-method=GET
gateway.routes[0].methods[2].http-path=/api/user
gateway.routes[0].methods[2].grpc-method=GetOneUserById

gateway.routes[0].methods[3].http-method=PUT
gateway.routes[0].methods[3].http-path=/api/user
gateway.routes[0].methods[3].grpc-method=UpdateUser

gateway.routes[0].methods[4].http-method=POST
gateway.routes[0].methods[4].http-path=/api/user/forgot-password
gateway.routes[0].methods[4].grpc-method=ForgotPassword
gateway.routes[0].methods[4].public-endpoint=true

gateway.routes[0].methods[5].http-method=POST
gateway.routes[0].methods[5].http-path=/api/user/change-password
gateway.routes[0].methods[5].grpc-method=ChangePassword
gateway.routes[0].methods[5].public-endpoint=true

gateway.routes[0].methods[6].http-method=POST
gateway.routes[0].methods[6].http-path=/api/user/refresh-token
gateway.routes[0].methods[6].grpc-method=RefreshToken
gateway.routes[0].methods[6].public-endpoint=true

gateway.routes[0].methods[7].http-method=POST
gateway.routes[0].methods[7].http-path=/api/user/logout
gateway.routes[0].methods[7].grpc-method=Logout

# Address Routes (Member Service)
gateway.routes[1].path=/api/address/**
gateway.routes[1].service=member
gateway.routes[1].grpc-service=member.address.AddressService
gateway.routes[1].public-route=false

gateway.routes[1].methods[0].http-method=POST
gateway.routes[1].methods[0].http-path=/api/address
gateway.routes[1].methods[0].grpc-method=UpsertAddress

gateway.routes[1].methods[1].http-method=GET
gateway.routes[1].methods[1].http-path=/api/address
gateway.routes[1].methods[1].grpc-method=FindAddressById

gateway.routes[1].methods[2].http-method=DELETE
gateway.routes[1].methods[2].http-path=/api/address
gateway.routes[1].methods[2].grpc-method=DeleteAddressById

gateway.routes[1].methods[3].http-method=GET
gateway.routes[1].methods[3].http-path=/api/address/filter
gateway.routes[1].methods[3].grpc-method=FilterUserAddress

gateway.routes[1].methods[4].http-method=PUT
gateway.routes[1].methods[4].http-path=/api/address/default
gateway.routes[1].methods[4].grpc-method=SetUserDefaultAddress

# =====================================================
# CATALOG SERVICE ROUTES
# =====================================================

# Search Routes (Catalog Service) - Public
# Note: GetProductDetails and GetProductSummary are in SearchService!
gateway.routes[2].path=/api/search/**
gateway.routes[2].service=catalog
gateway.routes[2].grpc-service=catalog.search.SearchService
gateway.routes[2].public-route=true

gateway.routes[2].methods[0].http-method=GET
gateway.routes[2].methods[0].http-path=/api/search
gateway.routes[2].methods[0].grpc-method=Search
gateway.routes[2].methods[0].public-endpoint=true

gateway.routes[2].methods[1].http-method=GET
gateway.routes[2].methods[1].http-path=/api/search/products
gateway.routes[2].methods[1].grpc-method=SearchProducts
gateway.routes[2].methods[1].public-endpoint=true

gateway.routes[2].methods[2].http-method=GET
gateway.routes[2].methods[2].http-path=/api/search/merchants
gateway.routes[2].methods[2].grpc-method=SearchMerchants
gateway.routes[2].methods[2].public-endpoint=true

gateway.routes[2].methods[3].http-method=GET
gateway.routes[2].methods[3].http-path=/api/product/details
gateway.routes[2].methods[3].grpc-method=GetProductDetails
gateway.routes[2].methods[3].public-endpoint=true

gateway.routes[2].methods[4].http-method=POST
gateway.routes[2].methods[4].http-path=/api/product/summary
gateway.routes[2].methods[4].grpc-method=GetProductSummary
gateway.routes[2].methods[4].public-endpoint=true

gateway.routes[2].methods[5].http-method=POST
gateway.routes[2].methods[5].http-path=/api/inventory/check
gateway.routes[2].methods[5].grpc-method=CheckInventory
gateway.routes[2].methods[5].public-endpoint=true

# Product Routes (Catalog Service) - Basic CRUD
gateway.routes[3].path=/api/product/**
gateway.routes[3].service=catalog
gateway.routes[3].grpc-service=catalog.product.ProductService
gateway.routes[3].public-route=true

gateway.routes[3].methods[0].http-method=GET
gateway.routes[3].methods[0].http-path=/api/product
gateway.routes[3].methods[0].grpc-method=FindProductById
gateway.routes[3].methods[0].public-endpoint=true

gateway.routes[3].methods[1].http-method=GET
gateway.routes[3].methods[1].http-path=/api/product/filter
gateway.routes[3].methods[1].grpc-method=FilterProduct
gateway.routes[3].methods[1].public-endpoint=true

gateway.routes[3].methods[2].http-method=GET
gateway.routes[3].methods[2].http-path=/api/product/by-sku
gateway.routes[3].methods[2].grpc-method=FindProductBySku
gateway.routes[3].methods[2].public-endpoint=true

# Merchant Routes (Catalog Service)
gateway.routes[4].path=/api/merchant/**
gateway.routes[4].service=catalog
gateway.routes[4].grpc-service=catalog.merchant.MerchantService
gateway.routes[4].public-route=true

gateway.routes[4].methods[0].http-method=GET
gateway.routes[4].methods[0].http-path=/api/merchant
gateway.routes[4].methods[0].grpc-method=FindMerchantById
gateway.routes[4].methods[0].public-endpoint=true

gateway.routes[4].methods[1].http-method=GET
gateway.routes[4].methods[1].http-path=/api/merchant/by-code
gateway.routes[4].methods[1].grpc-method=FindMerchantByCode
gateway.routes[4].methods[1].public-endpoint=true

gateway.routes[4].methods[2].http-method=GET
gateway.routes[4].methods[2].http-path=/api/merchant/filter
gateway.routes[4].methods[2].grpc-method=FilterMerchant
gateway.routes[4].methods[2].public-endpoint=true

# Category Routes (Catalog Service)
gateway.routes[5].path=/api/category/**
gateway.routes[5].service=catalog
gateway.routes[5].grpc-service=catalog.category.CategoryService
gateway.routes[5].public-route=true

gateway.routes[5].methods[0].http-method=GET
gateway.routes[5].methods[0].http-path=/api/category
gateway.routes[5].methods[0].grpc-method=FindCategoryById
gateway.routes[5].methods[0].public-endpoint=true

gateway.routes[5].methods[1].http-method=GET
gateway.routes[5].methods[1].http-path=/api/category/filter
gateway.routes[5].methods[1].grpc-method=FilterCategory
gateway.routes[5].methods[1].public-endpoint=true

gateway.routes[5].methods[2].http-method=GET
gateway.routes[5].methods[2].http-path=/api/category/by-slug
gateway.routes[5].methods[2].grpc-method=FindCategoryBySlug
gateway.routes[5].methods[2].public-endpoint=true

gateway.routes[5].methods[3].http-method=GET
gateway.routes[5].methods[3].http-path=/api/category/tree
gateway.routes[5].methods[3].grpc-method=GetCategoryTree
gateway.routes[5].methods[3].public-endpoint=true

# Brand Routes (Catalog Service)
gateway.routes[6].path=/api/brand/**
gateway.routes[6].service=catalog
gateway.routes[6].grpc-service=catalog.brand.BrandService
gateway.routes[6].public-route=true

gateway.routes[6].methods[0].http-method=GET
gateway.routes[6].methods[0].http-path=/api/brand
gateway.routes[6].methods[0].grpc-method=FindBrandById
gateway.routes[6].methods[0].public-endpoint=true

gateway.routes[6].methods[1].http-method=GET
gateway.routes[6].methods[1].http-path=/api/brand/filter
gateway.routes[6].methods[1].grpc-method=FilterBrand
gateway.routes[6].methods[1].public-endpoint=true

gateway.routes[6].methods[2].http-method=GET
gateway.routes[6].methods[2].http-path=/api/brand/by-slug
gateway.routes[6].methods[2].grpc-method=FindBrandBySlug
gateway.routes[6].methods[2].public-endpoint=true

# =====================================================
# CART SERVICE ROUTES
# =====================================================

# Cart Routes (Cart Service)
gateway.routes[7].path=/api/cart/**
gateway.routes[7].service=cart
gateway.routes[7].grpc-service=cart.cart.CartService
gateway.routes[7].public-route=false

gateway.routes[7].methods[0].http-method=GET
gateway.routes[7].methods[0].http-path=/api/cart/{user_id}
gateway.routes[7].methods[0].grpc-method=GetCart

gateway.routes[7].methods[1].http-method=POST
gateway.routes[7].methods[1].http-path=/api/cart/add
gateway.routes[7].methods[1].grpc-method=AddItem

gateway.routes[7].methods[2].http-method=POST
gateway.routes[7].methods[2].http-path=/api/cart/bulk-add
gateway.routes[7].methods[2].grpc-method=BulkAddItems

gateway.routes[7].methods[3].http-method=POST
gateway.routes[7].methods[3].http-path=/api/cart/remove
gateway.routes[7].methods[3].grpc-method=RemoveItem

gateway.routes[7].methods[4].http-method=POST
gateway.routes[7].methods[4].http-path=/api/cart/bulk-remove
gateway.routes[7].methods[4].grpc-method=BulkRemoveItems

gateway.routes[7].methods[5].http-method=PUT
gateway.routes[7].methods[5].http-path=/api/cart/update
gateway.routes[7].methods[5].grpc-method=UpdateItem

gateway.routes[7].methods[6].http-method=DELETE
gateway.routes[7].methods[6].http-path=/api/cart/{user_id}
gateway.routes[7].methods[6].grpc-method=ClearCart

# Checkout Routes (Cart Service)
gateway.routes[8].path=/api/checkout/**
gateway.routes[8].service=cart
gateway.routes[8].grpc-service=cart.checkout.CheckoutService
gateway.routes[8].public-route=false

gateway.routes[8].methods[0].http-method=POST
gateway.routes[8].methods[0].http-path=/api/checkout/prepare
gateway.routes[8].methods[0].grpc-method=PrepareCheckout

gateway.routes[8].methods[1].http-method=GET
gateway.routes[8].methods[1].http-path=/api/checkout/{checkout_id}
gateway.routes[8].methods[1].grpc-method=GetCheckout

gateway.routes[8].methods[2].http-method=POST
gateway.routes[8].methods[2].http-path=/api/checkout/{checkout_id}/finalize
gateway.routes[8].methods[2].grpc-method=FinalizeCheckout

gateway.routes[8].methods[3].http-method=POST
gateway.routes[8].methods[3].http-path=/api/checkout/{checkout_id}/pay
gateway.routes[8].methods[3].grpc-method=PayCheckout

gateway.routes[8].methods[4].http-method=POST
gateway.routes[8].methods[4].http-path=/api/checkout/{checkout_id}/cancel
gateway.routes[8].methods[4].grpc-method=CancelCheckout

gateway.routes[8].methods[5].http-method=GET
gateway.routes[8].methods[5].http-path=/api/checkout/user/{user_id}
gateway.routes[8].methods[5].grpc-method=GetCheckoutByUser

gateway.routes[8].methods[6].http-method=GET
gateway.routes[8].methods[6].http-path=/api/checkouts
gateway.routes[8].methods[6].grpc-method=FilterCheckouts

# Legacy checkout routes (deprecated but still supported)
gateway.routes[8].methods[7].http-method=POST
gateway.routes[8].methods[7].http-path=/api/checkout/validate
gateway.routes[8].methods[7].grpc-method=ValidateAndReserve

gateway.routes[8].methods[8].http-method=POST
gateway.routes[8].methods[8].http-path=/api/checkout/invalidate
gateway.routes[8].methods[8].grpc-method=InvalidateCheckout
